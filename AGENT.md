# AGENT Guide

> 상세 코딩 단계는 항상 `docs/detailed-coding-plan.md`에 기록하며, 이 문서는 **다음 스텝**의 구체적인 작업 지침만 포함합니다. 다음 스텝을 완료하면 여기에서 새 스텝을 정의하고, 세부 계획 문서도 그 스텝에 맞춰 갱신하세요.
> 전체 구조와 흐름은 `docs/ux-plan.md`와 `docs/main-plan.md`를 기준으로 하며, 모든 다음 스텝 계획은 반드시 두 문서를 교차 참조하여 작성합니다.

## Last Update
- 펌웨어를 단일 SWEEP 명령만 지원하도록 단순화하고, 웹앱에서도 진행률/상태 메시지/고급 설정 등 불필요한 기능을 제거했습니다.
- UI는 연결 패널 + 스윕 버튼 + 그래프/피팅/로그로 구성되는 최소 형태가 되었으며, Mock 모드와 CSV 포맷도 이에 맞춰 조정했습니다.
- README와 UX 문서를 새 구조에 맞게 갱신했습니다.

## Next Step
- Mock/실장 장치 모두에 대한 테스트 체크리스트와 간단한 QA 흐름을 문서화한다.
- 피팅 실패/샘플 부족 등의 오류 메시지 가이드를 보강하고, 배너/알림 체계를 정리한다.
- 반복 스윕이나 데이터 메모 등 교사용 추가 기능의 요구사항을 수집한다.

## Current Snapshot
- 웹앱은 연결 후 버튼 한 번으로 스윕을 수행하고, 12개 이상 데이터를 받으면 자동으로 Malus 피팅을 실행한다.
- 진행률/상태 메시지/고급 설정이 제거되어 유지보수가 쉬워졌으며, CSV와 로그는 각도・조도만 저장한다.

## Migration Plan
### Reuse (as-is)
- `vendor/chart.umd.js`, `js/dialog-polyfill.js`, `js/utils/format.js`, `js/utils/malusFit.js` 등 공용 모듈은 그대로 유지한다.

### Adapted
- `index.html`/`styles.css`: 단계 네비게이션과 고급 설정을 제거하고 단일 스윕 UI로 단순화.
- `js/state.js`: 스윕 진행 상태·설정 관련 필드를 제거하고 히스토리/피팅 중심으로 축소.
- `js/bluetooth.js`: `SWEEP` 단일 명령과 `RESET`만 송신하도록 축소.
- UI 모듈(`connection-panel`, `measurement-controls`, `intensity-chart`, `fit-summary`, `data-log`, `banner`)을 새 상태 구조에 맞게 정리.
- Mock 텔레메트리를 단일 스윕 시나리오만 재현하도록 축소.

### New / Remaining
- 통합 테스트 체크리스트 및 오류 처리 가이드 작성.
- 반복 스윕, 메모, 보고서 내보내기 등 교사용 확장 기능 기획.
- 실제 장치 연결 시 예외 상황(연결 실패, 데이터 누락) 대응 전략 수립.

### Procedure Outline
1. 테스트/QA 문서를 작성하고 기본 오류 시나리오를 검증한다.
2. 교사용 확장 기능 요구사항을 수집하고 우선순위를 정한다.
3. 펌웨어/웹앱 프로토콜 문서를 마무리하고 README를 주기적으로 갱신한다.

## On Deck (after Next Step)
- 테스트 체크리스트 기반의 QA 실행 및 자동화 도구 검토.
- 교사용 확장 기능 프로토타입 설계.
- 문서 및 배포 흐름 정비.

## Notes / Open Questions
- 피팅 최소 샘플 수(현재 12개)와 메시지 문구를 수업 맥락에 맞게 조정할 필요가 있는가?
- Mock 데이터의 위상/노이즈 파라미터를 어떻게 다양화할지 결정 필요.
- 실제 장치에서 스윕 도중 통신 장애가 발생하면 어떻게 복구할지 전략이 필요함.
