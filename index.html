<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>MalussBit Console</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app">
      <aside class="sidebar">
        <section class="card card--branding">
          <h1>MalussBit</h1>
          <p class="tagline">말루스 법칙 실험 도우미</p>
        </section>

        <section class="card" data-component="step-indicator">
          <h2>진행 단계</h2>
          <ol class="step-list">
            <li data-step="prepare" class="step-item">
              <span class="step-index">1</span>
              <span class="step-label" data-role="label">준비</span>
            </li>
            <li data-step="measure" class="step-item">
              <span class="step-index">2</span>
              <span class="step-label" data-role="label">측정</span>
            </li>
            <li data-step="analyze" class="step-item">
              <span class="step-index">3</span>
              <span class="step-label" data-role="label">분석</span>
            </li>
          </ol>
        </section>

        <section class="card" data-component="connection-panel">
          <h2>준비</h2>
          <p class="status-text" data-bind="status">연결 대기 중입니다.</p>
          <p class="device-label" data-bind="device"></p>
          <div class="button-group">
            <button type="button" data-action="connect">블루투스 연결</button>
            <button type="button" data-action="disconnect" disabled>연결 해제</button>
            <button type="button" class="ghost" data-action="device-reset">장치 리셋</button>
          </div>
          <p class="helper" data-bind="helper">micro:bit 전원이 켜져 있고 페어링 모드인지 확인하세요.</p>
        </section>

        <section class="card" data-component="measurement-panel">
          <h2>측정</h2>
          <p class="section-copy">측정 시작 시 서보 스윕과 데이터 수집을 진행합니다.</p>
          <button type="button" class="primary" data-action="toggle-measurement" disabled>측정 시작</button>
          <div class="progress" aria-hidden="true">
            <div class="progress-bar" data-role="progress-bar"></div>
          </div>
          <p class="progress-label" data-role="progress-label">연결 후 측정을 시작하세요.</p>
        </section>

        <section class="card" data-component="analysis-panel">
          <h2>분석</h2>
          <p class="section-copy" data-role="helper">측정을 완료하면 결과를 확인할 수 있습니다.</p>
          <div class="analysis-result" data-role="result" hidden>
            <div class="metric">
              <span class="metric-label">A (진폭)</span>
              <span class="metric-value" data-field="amplitude">—</span>
            </div>
            <div class="metric">
              <span class="metric-label">B (오프셋)</span>
              <span class="metric-value" data-field="offset">—</span>
            </div>
            <div class="metric">
              <span class="metric-label">φ (위상)</span>
              <span class="metric-value" data-field="phase">—</span>
            </div>
            <div class="metric">
              <span class="metric-label">R²</span>
              <span class="metric-value" data-field="rSquared">—</span>
            </div>
            <div class="metric">
              <span class="metric-label">최대 조도</span>
              <span class="metric-value" data-field="maxAt">—</span>
            </div>
            <div class="metric">
              <span class="metric-label">최소 조도</span>
              <span class="metric-value" data-field="minAt">—</span>
            </div>
          </div>
          <p class="analysis-status" data-role="status-text"></p>
          <div class="button-group">
            <button type="button" data-action="download-csv" disabled>CSV 다운로드</button>
            <button type="button" data-action="run-fit" disabled>피팅 실행</button>
          </div>
        </section>
      </aside>

      <section class="content">
        <div class="card status-card" data-component="status-banner" hidden>
          <p class="status-message" data-role="status"></p>
          <p class="status-warning" data-role="warning"></p>
        </div>

        <section class="card chart-card" data-component="light-chart">
          <header class="card-header">
            <h2>실시간 그래프</h2>
            <p class="meta" data-role="meta">샘플이 수집되면 그래프가 표시됩니다.</p>
          </header>
          <div class="chart-area">
            <canvas width="640" height="360"></canvas>
            <p class="empty" data-role="empty">아직 수집된 데이터가 없습니다.</p>
          </div>
        </section>

        <section class="card" data-component="notes-panel">
          <h2>실험 노트</h2>
          <textarea rows="5" placeholder="실험 메모를 남겨 주세요." disabled></textarea>
          <p class="helper">노트 기능은 후속 단계에서 활성화됩니다.</p>
        </section>
      </section>
    </main>

    <script src="vendor/chart.umd.js"></script>
    <script type="module" src="js/app.js"></script>
  </body>
</html>
