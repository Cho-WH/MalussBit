# 말루스의 법칙 실험 장비 및 웹앱 구상 (micro:bit)

> 버전: 0.1 초안
> 작성: (여기에 입력)
> 대상: 고등학교 물리 실험 (1–2차시)

---

## 1) 목표

* **말루스의 법칙** (I = I_0 \cos^2(\theta + \phi_0))을 실험적으로 확인한다.
* 서보모터로 **분석기(Analyzer)** 각도를 연속적으로 변화시키며, **마이크로비트 내장 조도 센서** 값을 동시에 기록한다.
* **BLE UART**를 통해 각도·조도 데이터를 **노트북 웹앱**으로 실시간 전송·시각화·피팅한다.

## 2) 실험 원리 요약

* 선편광 빛이 분석기를 통과하면 **강도**는 (I(\theta) = I_0 \cos^2(\theta + \phi_0)).
* 여기서 (\theta)는 **분석기와 편광자(기준) 사이의 상대각**이고, (\phi_0)는 0점 오프셋(정렬 오차)이다.
* 측정된 조도 신호 (S)는 센서 비선형·암전류 때문에 (S \approx a,I + b)로 모델링하고,
  **정규화/보정**으로 말루스 형태에 맞춘다.

---

## 3) 시스템 구성

### 하드웨어(BOM)

* **BBC micro:bit v2** ×1
* **서보모터**(EF92A 등 아날로그 마이크로/표준 서보) ×1
* **외부 전원**: 4×AA 배터리팩(≈6 V) 또는 5 V 어댑터(서보 전용)
* **공통 GND**: 서보 전원 GND ↔ micro:bit GND 공통
* **선편광자(Polarizer)** ×1, **분석기(Analyzer)** ×1 (편광 필름 2장)
* **내장 디지털 조도 센서**(선형성 향상)

### 배선

* 서보 **신호**: P1 → 서보 신호선(노랑/주황)
* **전원**: 서보 +5 V(외부) / micro:bit 3V는 서보에 **공급 금지**
* **GND 공통**: 서보 GND ↔ micro:bit GND 연결
* 조도 센서: 기본은 **내장 조도(input.lightLevel)** 사용. 

### 광학 배치(개략)

`LED 광원` → `확산지` → `편광자(기준, 고정)` → `분석기(회전, 서보 고정)` → `센서(마이크로비트)`

---

## 4) 펌웨어 설계(마이크로비트, MakeCode)

### 핵심 아이디어

* **스윕 과정:** step마다 작은 각도도 조정. 매 샘플마다 `angle_cmd`(지시각)과 `light`를 함께 전송.

### 데이터 포맷(한 줄/샘플)

* 최소: `ms,angle_cmd,light`
* 확장: `ms,angle_cmd,angle_est,light`

### 권장 파라미터

* 샘플링: **20–50 Hz**(BLE 과부하 방지)
* 스윕 속도: 샘플링에 동기화하여 step 간격 20-50 ms 수준

---

## 5) 웹앱 설계(브라우저, Web Bluetooth)

### 기능 요구사항

1. **연결**: micro:bit의 BLE UART(Nordic UART) 서비스에 연결/해제
2. **수신/파싱**: 줄 단위 CSV 수신 → `t, angle_cmd, light` 파싱
3. **실시간 시각화**:

   * `light vs. angle` 산점도(스트리밍)
   * 최대, 최소 각도 표시
4. **피팅**: (S(\theta) = A\cos^2(\theta + \phi_0) + B)으로 비선형 최소제곱 적합

   * 결과: (A), (B), (\phi_0), 결정계수 (R^2)
   * **정규화 옵션**: (S_{norm} = (S - S_{min})/(S_{max}-S_{min}))
5. **데이터 관리**: CSV 다운로드, 이미지(그래프) 저장, 실험 메모 추가
6. **수업 모드**: 학생용 간소 UI(연결 → 스윕 → 결과) / 교사용 확장 기능은 별도 설계

### 기술 스택(권장)

* **Vanilla JS + Web Bluetooth API**
* 차트: `Chart.js` 또는 `uPlot`(가벼움)
* 피팅: 단순 **LM(Levenberg–Marquardt)** 또는 **Grid + Local** 하이브리드(의존성 최소화)

### 데이터 파이프라인(개략)

```
BLE Rx (text line) → CSV 파싱 → RingBuffer(최근 N점) →
실시간 차트 업데이트 ↔ 피팅(버튼 트리거/자동) → 결과/잔차 표시 → 저장
```

## 6) 절차(수업 운영 시나리오)

1. **세팅** (5–10분)

   * 장비 조립: 서보–분석기 부착, 광원–편광자 정렬
   * 전원: 서보 외부 전원 연결, **GND 공통** 확인, micro:bit 전원/USB 연결
   * 웹앱 준비: 페이지 열기 → micro:bit 연결 (또는 `?mock=1`로 Mock 모드 실행)
2. **영점/최대값 확인** (3–5분)

   * 분석기 손으로 0°/90° 근처 위치시켜 조도 최대/최소를 확인, 광로 정렬
3. **연속 스윕 측정** (5–10분)

   * 0→180°를 스윕, 실시간 그래프 관찰
4. **피팅/해석** (10–15분)

   * (A,B,\phi_0) 추정, 정규화 곡선과 비교
   * 잔차·R² 분석, 오차 요인 토의
5. **보고** (과제)

   * 그래프/매개변수/토의문항 포함 실험 보고서 제출

---

## 8) 평가 루브릭(예시)

* **데이터 품질(30)**: 노이즈/포화/외광 관리, 그래프 해상도
* **모델 적합(30)**: 피팅 진행, 매개변수·R² 보고
* **오차 분석(25)**: 계통·우연오차 구분, 개선 제안
* **보고서 구성(15)**: 목적–방법–결과–논의–결론 흐름

---

## 9) 부록 C: 말루스 피팅 함수(정규화 형태)

$$
S(\theta) = A\cos^2(\theta + \phi_0) + B,\quad  \theta = (\pi/180)\times(\text{deg})
$$

* 초기값 힌트: `A ≈ S_max - S_min`, `B ≈ S_min`, `φ0 ≈ θ@S_max`
* 각도는 **라디안**으로 변환하여 피팅

---

### 참고 메모

* micro:bit의 BLE UART는 **줄 단위 텍스트 스트림**이 안정적. 20–50 Hz로 충분.
* 서보 전원은 반드시 **분리**, GND 공통.
* 정밀한 실제각이 필요하다면 **엔코더/자석+홀센서/가변저항** 등 외부 각도 센서 추가.
